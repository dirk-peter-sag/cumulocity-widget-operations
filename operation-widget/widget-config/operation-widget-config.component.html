<div class="d-flex">
  <div class="col-sm-12">
    <div *ngIf="!config.device" class="col-sm-12">
      <h3 class="text-center m-b-16">Define Operation Buttons</h3>
      <h4 class="text-center">Before we can start you have to pick a device</h4>
    </div>

    <div *ngIf="config.device" class="col-sm-12">
      <h3 class="text-center m-b-16">Define Operation Buttons</h3>
      <div *ngIf="!config?.buttons?.length">
        <h4 class="text-center">No Buttons configured yet.</h4>
        <div class="j-c-center">
          <button class="m-16 btn btn-primary" (click)="addNewButton()">
            <i c8yIcon="plus"></i>Add first button
          </button>
        </div>
      </div>

      <div *ngFor="let item of config.buttons; let buttonIndex = index">
        <h3 class="col-sm-12 m-b-4" *ngIf="config.buttons.length >= 2">
          {{ buttonIndex + 1 }}. Button
        </h3>

        <div class="col-sm-4">
          <c8y-form-group>
            <label translate for="buttonClasses">Button Icon</label>
            <div class="dropdown" style="width: 100%" dropdown>
              <button type="button" title="Icon for button" style="width: 100%" dropdownToggle
                class="btn btn-default dropdown-toggle c8y-dropdown">
                <span><i [c8yIcon]="item.icon || 'refresh'"></i>
                  {{ item.icon ? item.icon : 'Choose Icon' }}</span>
                <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" *dropdownMenu>
                <li (click)="item.icon = iconClass" *ngFor="let iconClass of availableIcons">
                  <button type="button">
                    <i [c8yIcon]="iconClass"></i> {{ iconClass }}
                  </button>
                </li>
              </ul>
            </div>
          </c8y-form-group>
        </div>

        <div class="col-sm-4">
          <c8y-form-group>
            <label translate for="buttonClasses">Button Color</label>
            <div class="dropdown" style="width: 100%" dropdown>
              <button type="button" title="Color of the button" style="width: 100%" dropdownToggle [ngClass]="
                  'btn btn-default dropdown-toggle c8y-dropdown ' +
                  (item.buttonClasses || 'btn-warning')
                ">
                <span><i [c8yIcon]="item.icon"></i>
                  {{
                  item.buttonClasses ? item.buttonClasses : 'Choose Color'
                  }}</span>
              </button>

              <ul class="dropdown-menu" *dropdownMenu>
                <li (click)="item.buttonClasses = class" *ngFor="let class of buttonClasses">
                  <button type="button" style="width: 100%" [ngClass]="'btn ' + class">
                    <i [c8yButton]="item.button" [c8yIcon]="item.icon"></i>
                    {{ class }}
                  </button>
                </li>
              </ul>
            </div>
          </c8y-form-group>
        </div>

        <div class="col-sm-4">
          <c8y-form-group [hasWarning]="!item.label || item.label.length === 0">
            <label translate for="label">Label</label>
            <input id="label" class="form-control" type="text" name="label" [maxlength]="254" autocomplete="off"
              placeholder="e.g. Restart" [(ngModel)]="item.label" required />
            <c8y-messages>
              <c8y-message *ngIf="!item.label || item.label.length === 0" translate></c8y-message>
              <c8y-message name="required" text="'The label is required'"></c8y-message>
            </c8y-messages>
          </c8y-form-group>
        </div>

        <div class="col-sm-12">
          <operation-value [(value)]="item.operationValue"></operation-value>
        </div>

        <div class="col-sm-12">
          <c8y-form-group>
            <label translate for="icon">Requires confirmation</label>
            <label class="c8y-switch" title="{{ 'Active' | translate }}">
              <input type="checkbox" [(ngModel)]="item.showModal" />
              <span></span>
              <span>
                {{ 'Confirm operation' }}
              </span>
            </label>
            <input *ngIf="item.showModal" id="modalText" class="form-control" type="text" name="description"
              [maxlength]="254" autocomplete="off" placeholder="e.g. Restart device" [(ngModel)]="item.modalText" />
          </c8y-form-group>
        </div>

        <div class="col-sm-12">
          <button class="btn btn-danger" (click)="removeButton(buttonIndex)">
            <i c8yIcon="delete"></i>Delete this Operation
          </button>
        </div>
      </div>
    </div>

    <div *ngIf="config?.buttons?.length > 0" class="col-sm-12">
      <button class="m-t-16 m-b-16 btn btn-primary" (click)="addNewButton()">
        <i c8yIcon="plus"></i>Add button
      </button>
    </div>
  </div>
</div>
